# Scripts

All scripts come with a built-in help (`COMMAND -h`) and support for parameters, courtesy of [argbash.io](https://argbash.io/).

## copy_from_host

Copy files from remote host to local directory with resume support, showing progress bar. By default, the remote folder is prepended with `~/` unless it starts with some absolute path `/`, like `/home`.

### Common Usage

- Copy `~/results` folder and its contents from remote host `HOST` to current directory (which is default), showing one progress bar per file.
```bash
copy_from_host HOST results
```

- Copy `/workdir/results/` folder contents from remote host `HOST` to `~/last_results/` directory, excluding folders/files with `tensorboard_logs` string and showing only one progress bar.
```bash
copy_from_host HOST /workdir/results/ ~/last_results/ --excludes "*tensorboard_logs*" -s
```

## copy_to_host

Copy files from local directory to remote host with resume support, showing progress bar. By default, the remote folder is prepended with `~/` unless it starts with some absolute path `/`, like `/home`.

### Common Usage

- Copy all zip files in current folder to remote host `HOST` `~/pip_tmp/` directory and show one progress bar per file.
```bash
copy_to_host HOST \*.zip pip_tmp/
```

## download_file

Download files with `aria2c` with resume support.

### Common Usage

- Download `vgg16-397923af.pth` to current directory
```bash
download_file https://download.pytorch.org/models/vgg16-397923af.pth
```

- Download `vgg16-397923af.pth` to current directory and rename it as `weights.pth`
```bash
download_file https://download.pytorch.org/models/vgg16-397923af.pth -o weights.pth
```

- Download all files listed in `links.txt` to `downloads` folder. Note that `links.txt` must have one link per line, or be generated by [downthemall](https://www.downthemall.net/) `export as aria2 list` option in the download manager.
```bash
download_file -i links.txt -d downloads/
```

## find_dirs_with_file

Find directories with given file name.

### Common Usage

- Find subdirs of current directory with file `test.jpg`
```bash
find_dirs_with_file test.jpg
```

- Find subdirs of `~/test/` directory with `png` files, excluding `.git/` and `results/` directories
```bash
find_dirs_with_file .png ~/test/ -e ".git/ results/"
```

## launch_ai_docstring_docker_remote

Launch a [nvidia-docker](https://github.com/NVIDIA/nvidia-docker) container from `graykode/ai-docstring` image on a remote computer, redirecting the output of container port 5000 to local computer port 5001 (which can be changed). Created to be used with [VSCode Python AI Docstring Generator](https://marketplace.visualstudio.com/items?itemName=graykode.ai-docstring) extension.

> `nvidia-docker` must be installed on remote computer

### Common Usage

- Launch on remote host `HOST` a container with name `ai_docstring_$USER` based on `graykode/ai-docstring` image, redirecting port 5000 of container to local computer port 5001.
```bash
launch_ai_docstring_docker_remote HOST
```

- Launch on remote host `HOST` a container with name `docstring_generator` based on `graykode/ai-docstring` image, redirecting port 5000 of container to local computer port 5005.
```bash
launch_ai_docstring_docker_remote HOST -c docstring_generator -p 5005
```

## launch_jupyter_docker_remote

Launch jupyter notebook in a docker container in remote computer, redirecting its ports to local ports.

### Common Usage

- Launch jupyter notebook in remote host `HOST` in `~/tmp` folder, creating a docker container from image `$USER/jupyter`, and redirecting its port 8888 to same local port.
```bash
launch_jupyter_docker_remote HOST tmp
```

- Launch jupyter notebook in remote host `HOST` in `~/tmp` folder, setting docker container name to `tmp_container`, use docker image `jupyter_image`, forward container port 8888 to local port 8889, and set gnu screen name to `jupyter_screen`.
```bash
launch_jupyter_docker_remote HOST tmp -c tmp_container -i jupyter_image -p 8889 -s jupyter_screen
```

## launch_jupyter_remote

Launch jupyter notebook in remote computer inside a virtualenv if provided, redirecting its ports to local ports.

### Common Usage

- Launch jupyter notebook in remote host `HOST` in `~/tmp` folder, redirecting its port 8888 to same local port.
```bash
launch_jupyter_remote HOST tmp
```

- Launch jupyter notebook in remote host `HOST` in `~/tmp` folder, setting virtualenv to `jupyter_env`, forward container port 8888 to local port 8889, and set gnu screen name to `jupyter_screen`.
```bash
launch_jupyter_remote HOST tmp -v jupyter_env -p 8889 -s jupyter_screen
```

## launch_tensorboard_docker_remote

Launch tensorboard in a docker container in remote computer, redirecting its ports to local ports.

### Common Usage

- Launch tensorboard in remote host `HOST` in `~/tmp` folder, creating a docker container from image `$USER/jupyter`, and redirecting its port 6006 to same local port.
```bash
launch_tensorboard_docker_remote HOST tmp
```

- Launch tensorboard in remote host `HOST` in `~/tmp` folder, setting docker container name to `tmp_container`, use docker image `tb_image`, forward container port 6006 to local port 6007, and set gnu screen name to `tb_screen`.
```bash
launch_tensorboard_docker_remote HOST tmp -c tmp_container -i tb_image -p 6007 -s tb_screen
```

## launch_tensorboard_remote

Launch tensorboard in remote computer inside a virtualenv if provided, redirecting its ports to local ports.

### Common Usage

- Launch tensorboard in remote host `HOST` in `~/tmp` folder, redirecting its port 6006 to same local port.
```bash
launch_tensorboard_remote HOST tmp
```

- Launch tensorboard in remote host `HOST` in `~/tmp` folder, setting virtualenv to `tb_env`, forward container port 6006 to local port 6007, and set gnu screen name to `tb_screen`.
```bash
launch_tensorboard_remote HOST tmp -v tb_env -p 6007 -s tb_screen
```

## login_remote_host

Login in remote host and (re)open gnu screen session. Useful if you are in an unstable connection or is running a long experiment that may be halted if you lose connection.

### Common Usage

- Connect to remote host `HOST` and create/reconnect to a gnu screen session with name `$USER`.
```bash
login_remote_host HOST
```

- Connect to remote host `HOST`, create/reconnect to a gnu screen session with name `$USER`, redirecting ports 5000 and 6006 to same local ports.
```bash
login_remote_host HOST -p "5000 6006"
```

- Connect to remote host `HOST` and run command `nvtop`.
```bash
login_remote_host HOST -c nvtop
```

- Connect to remote host `HOST` and create/reconnect to a gnu screen session with name `test`.
```bash
login_remote_host HOST -s test
```

## print_line_from_file

Read specific line from file, with syntax highlight support.

### Common Usage

- Read line 10 from file `FILE`.
```bash
print_line_from_file 10 FILE
```

- Read line 10 from file `test.json`.
```bash
print_line_from_file 10 test.json -s -l json
```

## search_str

Search for string in directory, excluding git, pycache, and any extra given information.

### Common Usage

- Search for string `STR` inside of files in current directory.
```bash
search_str STR
```

- Search for string `STR` inside of files in the `~/Downloads` directory.
```bash
search_str STR ~/Downloads
```

- Search for string `name` inside of files in current directory, ignoring case, and excluding when the string happens as `nameof` or `myname`.
```bash
search_str name -i --excludes_str "nameof myname"
```

- Search for string `STR` inside of files in current directory, displaying only the name of the files where it happens.
```bash
search_str STR -l
```

- Search for string `STR` inside of files in current directory, displaying only the name of the files where it does NOT happens.
```bash
search_str STR --files_without_matches
```